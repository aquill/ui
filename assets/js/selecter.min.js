/*
 * Selecter Plugin [Formtone Library]
 * @author Ben Plum
 * @version 2.2.8
 *
 * Copyright Â© 2013 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
 
jQuery&&function(a){function g(b){var c,d,f;for(b=a.extend({},e,b||{}),c=a(this),d=0,f=c.length;f>d;d++)h(c.eq(d),b);return c}function h(c,e){var f,g,h,i,l,n,s,t;c.hasClass("selecter-element")||(e=a.extend({},e,c.data("selecter-options")),e.externalLinks&&(e.links=!0),f=c.find("option, optgroup"),g=f.filter("option"),h=g.filter(":selected"),i=e.defaultLabel?-1:g.index(h),l=e.links?"nav":"div",e.multiple=c.prop("multiple"),e.disabled=c.is(":disabled"),n="<"+l+' class="selecter'+e.customClass,d?n+=" mobile":e.cover&&(n+=" cover"),n+=e.multiple?" multiple":" closed",e.disabled&&(n+=" disabled"),n+='">',e.multiple||(n+='<span class="selecter-selected icon-select">',n+=a("<span></span").text(u(e.trimOptions,0!=e.defaultLabel?e.defaultLabel:h.text())).html(),n+="</span>"),n+='<div class="selecter-wrapper"><dl class="selecter-options">',n+="</dl></div>",n+="</"+l+">",c.addClass("selecter-element").after(n),s=c.next(".selecter"),t=a.extend({$select:c,$allOptions:f,$options:g,$selecter:s,$selected:s.find(".selecter-selected"),$wrapper:s.find(".selecter-wrapper"),$selectOptions:s.find(".selecter-options"),index:i,guid:b++},e),j(t),void 0!=a.fn.scroller&&t.$wrapper.scroller(),t.$selecter.on("click.selecter",".selecter-selected",t,k).on("click.selecter",".selecter-item",t,o).on("selecter-close",t,m).data("selecter",t),!t.links&&!d||d?(t.$select.on("change",t,p).on("blur.selecter",t,r),d||t.$select.on("focus.selecter",t,q)):t.$select.hide())}function j(b){var f,g,h,i,c="",d=b.links?"a":"dd",e=0;for(f=0,g=b.$allOptions.length;g>f;f++)h=b.$allOptions.eq(f),"OPTGROUP"==h[0].tagName?(c+='<dt class="selecter-group',h.is(":disabled")&&(c+=" disabled"),c+='">'+h.attr("label")+"</dt>"):(i=h.val(),h.attr("value")||h.attr("value",i),c+="<"+d+' class="selecter-item',h.is(":selected")&&!b.defaultLabel&&(c+=" selected"),h.is(":disabled")&&(c+=" disabled"),c+='" ',c+=b.links?'href="'+i+'"':'data-value="'+i+'"',c+="><i>"+a("<span></span>").text(u(b.trimOptions,h.text())).html()+"</i></"+d+">",e++);b.$selectOptions.html(c),b.$items=b.$selecter.find(".selecter-item")}function k(b){var c,e,f;b.preventDefault(),b.stopPropagation(),c=b.data,c.$select.is(":disabled")||(a(".selecter").not(c.$selecter).trigger("selecter-close",[c]),d?(e=c.$select[0],document.createEvent?(f=document.createEvent("MouseEvents"),f.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(f)):element.fireEvent&&e.fireEvent("onmousedown")):c.$selecter.hasClass("closed")?l(b):c.$selecter.hasClass("open")&&m(b))}function l(b){var c,d,e,f,g;b.preventDefault(),b.stopPropagation(),c=b.data,c.$selecter.hasClass("open")||(d=c.$selecter.offset(),e=a("body").outerHeight(),f=c.$wrapper.outerHeight(!0),d.top+f>e&&c.$selecter.addClass("bottom"),c.$wrapper.show(),c.$selecter.removeClass("closed").addClass("open"),a("body").on("click.selecter-"+c.guid,":not(.selecter-options)",c,n),g=c.index>=0?c.$items.eq(c.index).position():{left:0,top:0},void 0!=a.fn.scroller?c.$wrapper.scroller("scroll",c.$wrapper.find(".scroller-content").scrollTop()+g.top,0).scroller("reset"):c.$wrapper.scrollTop(c.$wrapper.scrollTop()+g.top))}function m(b){b.preventDefault(),b.stopPropagation();var c=b.data;c.$selecter.hasClass("open")&&(c.$wrapper.hide(),c.$selecter.removeClass("open").addClass("closed"),a("body").off(".selecter-"+c.guid))}function n(b){b.preventDefault(),b.stopPropagation(),0==a(b.currentTarget).parents(".selecter").length&&m(b)}function o(b){var c,d,e;b.preventDefault(),b.stopPropagation(),c=a(this),d=b.data,d.$select.is(":disabled")||(d.$wrapper.is(":visible")&&(e=d.$items.index(c),t(e,d,!1)),d.multiple||m(b))}function p(b,c){var e,f,g;c||(e=a(this),f=b.data,f.links?d?v(e.val(),f.externalLinks):v(e.attr("href"),f.externalLinks):f.multiple||(g=f.$options.index(f.$options.filter("[value='"+w(e.val())+"']")),t(g,f,!1)))}function q(b){b.preventDefault(),b.stopPropagation();var c=b.data;c.$select.is(":disabled")||c.multiple||(c.$selecter.addClass("focus"),a(".selecter").not(c.$selecter).trigger("selecter-close",[c]),a("body").on("keydown.selecter-"+c.guid,c,s))}function r(b){b.preventDefault(),b.stopPropagation();var c=b.data;c.$selecter.removeClass("focus"),a(".selecter").not(c.$selecter).trigger("selecter-close",[c]),a("body").off(".selecter-"+c.guid)}function s(b){var e,f,g,h,d=b.data;if(d.$selecter.hasClass("open")&&13==b.keyCode)t(d.index,d,!1),m(b);else if(!(9==b.keyCode||b.metaKey||b.altKey||b.ctrlKey||b.shiftKey)){if(b.preventDefault(),b.stopPropagation(),e=d.$items.length-1,f=-1,a.inArray(b.keyCode,c?[38,40,37,39]:[38,40])>-1)f=d.index+(38==b.keyCode||c&&37==b.keyCode?-1:1),0>f&&(f=0),f>e&&(f=e);else{for(g=String.fromCharCode(b.keyCode).toUpperCase(),i=d.index+1;e>=i;i++)if(h=d.$options.eq(i).text().charAt(0).toUpperCase(),h==g){f=i;break}if(0>f)for(i=0;e>=i;i++)if(h=d.$options.eq(i).text().charAt(0).toUpperCase(),h==g){f=i;break}}f>=0&&t(f,d,!0)}}function t(a,b,c){var h,e=b.$items.eq(a),f=e.hasClass("selected"),g=e.hasClass("disabled");if(!g){if(!f||b.links){if(h=e.html(),e.data("value"),b.multiple)b.$options.eq(a).prop("selected",!0);else if(b.$selected.html(h),b.$items.filter(".selected").removeClass("selected"),b.$select[0].selectedIndex=a,b.links&&!c)return d?v(b.$select.val(),b.externalLinks):v(e.attr("href"),b.externalLinks),void 0;b.$select.trigger("change",[!0]),e.addClass("selected")}else b.multiple&&(b.$options.eq(a).prop("selected",null),e.removeClass("selected"));(!f||b.multiple)&&(b.callback.call(b.$selecter,b.$select.val(),a),b.index=a)}}function u(a,b){return a===!1?b:b.length>a?b.substring(0,a)+"...":b}function v(a,b){b?window.open(a):window.location.href=a}function w(a){return a.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")}var b=0,c=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,d=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera),e={callback:a.noop,cover:!1,customClass:"",defaultLabel:!1,externalLinks:!1,links:!1,trimOptions:!1},f={defaults:function(b){return e=a.extend(e,b||{}),a(this)},disable:function(b){return a(this).each(function(c,d){var f,e=a(d).next(".selecter").data("selecter");"undefined"!=typeof b?(f=e.$items.index(e.$items.filter("[data-value="+b+"]")),e.$items.eq(f).addClass("disabled"),e.$options.eq(f).prop("disabled",!0)):(e.$selecter.hasClass("open")&&e.$selecter.find(".selecter-selected").trigger("click"),e.$selecter.addClass("disabled"),e.$select.prop("disabled",!0))})},enable:function(b){return a(this).each(function(c,d){var f,e=a(d).next(".selecter").data("selecter");"undefined"!=typeof b?(f=e.$items.index(e.$items.filter("[data-value="+b+"]")),e.$items.eq(f).removeClass("disabled"),e.$options.eq(f).prop("disabled",!1)):(e.$selecter.removeClass("disabled"),e.$select.prop("disabled",!1))})},destroy:function(){return a(this).each(function(b,c){var d=a(c),e=d.next(".selecter");e.hasClass("open")&&e.find(".selecter-selected").trigger("click"),void 0!=a.fn.scroller&&e.find(".selecter-options").scroller("destroy"),d.off(".selecter").removeClass("selecter-element").show(),e.off(".selecter").remove()})}};a.fn.selecter=function(a){return f[a]?f[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:g.apply(this,arguments)}}(jQuery);